---

layout: post
title: BFF
category: 架构
tags: Architecture
keywords: bff

---

## 简介（未完成）

* TOC
{:toc}


GraphQL is a query language for APIs and a runtime for fulfilling those queries with your existing data. [为什么我使用 GraphQL 而放弃 REST API？](https://mp.weixin.qq.com/s/n1HGGe4_Ty8q7sMbORCADg)



用搭积木的方式写业务

[GraphQL及元数据驱动架构在后端BFF中的实践](https://mp.weixin.qq.com/s/mhM9tfWBlIuMVkZQ-6C0Tw)

[glue](https://github.com/qiankunli/glue)



[聊聊我对 GraphQL 的一些认知](https://mp.weixin.qq.com/s/ZBZ4o8qsyQzTuxIJgfKRVA)  GraphQL 留给我的印象就停留在这些无法解决的问题上。曾经有人咨询我想用 GraphQL 去重构某个服务，被我比较激动的给打消了这个念头。

## 需求

1. 不知道大家有没有遇到过这样的一些场景，某个服务有几十个接口，更有甚者上百个也是有可能的。APP 或者其他下游要封装一个功能，需要调用 10 个接口左右，可能这些接口还涉及到不同的团队。不管开发，联调，测试，还是对于调用方，整个链条功能太多了。随着这些功能经过多个版本的迭代升级后，新+旧版本的接口谁也不敢大规模改动了，只能在原来的基础上做代码拼接，这基本就是祖传代码的由来。大部分同学基本的代码素养是有的，但是也只能任由这些祖传代码慢慢腐烂，原因为很简单，谁也不敢保证改动之后功能是不是有遗漏的地方。有没有这样一个功能，将这些接口做一下聚合，然后将结果的集合返回给前端呢？在目前比较流行微服务架构体系下，有一个专门的中间层专门来处理这个事情，这个中间层叫 BFF（Backend For Frontend）。
2. 当用户打开这个页面的时候，按照目前比较流行的 REST 接口，需要 APP 至少发起下面这些请求：获取商品详情接口；获取商品价格、优惠相关的接口；获取评价接口；获取种草秀接口；获取问答接口。这些接口一般来说都比较重，里面有很多当前页面并不需要的字段，那有没有一种可能：APP 端发一次请求就能获取这个页面需要的所有字段，同时 APP 还能根据自己的需求只请求自己需要的字段呢？

```
query jdGoodsQuery {
     goods {
        detail {
          id
          pictures(first: 10) {
            pic_id
            thumb
          }
          spec {
            name
            size
            weight
          }
        }
        price {
          price
          origin_price
          market_price
        }
        comment(first: 10) {
          comment_id
          topic_id
          content
          from_uid
        }
        self_show(first: 10) {
          id
          pic_id
        }
    }
}
```

对于上面京东商品详情的截图，类似这样的一个 Query 就可以把这个页面需要的所有的字段都获取到。




